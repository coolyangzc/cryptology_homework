#include "GMAC.h"

#include <cstdio>
#include <iostream>

using namespace std;

const uint8_t key[16] = {0x3A,0xE1,0x15,0x62,0xA8,0xF3,0xC7,0x1A,0x2B,0xF6,0xDF,0xA1,0x50,0x9B,0xCA,0xF1};
const char A[] = "yangzhican2013011377";
const uint8_t zero[16] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
const uint8_t IV[12] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
int main()
{
    uint128_t T = GMAC::encrypt(NULL, 0, IV, zero, true);
    T.print("\nT:\n");
    puts("---------------------------------");

    puts("Key:");
    rep(i, 16)
        printf("%02x", key[i]);
    puts("");

    T = GMAC::encrypt(A, IV, key, true);
    T.print("\nT:\n");
    return 0;
}
